---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
```{r loadactivity}
library(data.table)
library(reshape2)
activity <- read.csv("activity.csv", header = T)
activity <- data.table(activity)
```


## What is mean total number of steps taken per day?
```{r extracting total activity per day, echo=FALSE}
#Let's calculate the total steps per day 
activity[,totalperday:= sum(steps), by=date]

#Let's extract out the individual dates and associate the unique activity with that day
date_activity <- as.data.frame(activity$date)
date_activity <- cbind(date_activity, activity$totalperday)
date_activity <- unique(date_activity)
hist(activity$totalperday, xlab = "Total Activity per day" )
```

```{r meanTotalSteps, echo=F}
meanTotalSteps = mean(activity$totalperday,na.rm = T)
medianTotalSteps = median(activity$totalperday, na.rm=T)
```

## What is the average daily activity pattern?
```{r calculating average steps per day}
melted <- melt(activity, id.vars = "interval", measure.vars="steps", value.name = "steps", na.rm = T)
average_daily_activity <- dcast(melted,interval~variable, mean)
plot(type="l",y=average_daily_activity$steps, x=average_daily_activity$interval, xlab="5 min interval", ylab="Average Steps Taken")
average_daily_activity[which.max(average_daily_activity$steps),]



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?